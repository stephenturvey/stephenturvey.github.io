function smc_error(n,t){alert("Sorry, an unexpected error just occurred. Please try refreshing.\r\n\r\nIT Support have been notified of the problem.\r\n\r\n[error "+n+"]"),t==undefined&&(t=""),t.length>200&&(t=t.substr(0,200));var i=new Image;return i.src="../mcp-error.ashx?x="+n+"&y="+t+"&z=SMC",!1}function smc_init(){var f=new Image,u,r,n,t,i;f.src="../action/staff-module-chooser-fetch.ashx?warm=1";if(!(typeof window.GetHttpObj=="function")){alert("This page did not load correctly and some functionality will be missing.\r\n\r\nPlease refresh the page.");return}u=document.getElementById("quallist");if(!u)return smc_error(1);u.selectedIndex=0,r=document.getElementById("pathlist");if(!r)return smc_error(4);r.disabled="disabled",n=document.getElementById("studpi");if(!n)return smc_error(12);n.value="",t=document.getElementById("user1");if(!t)return smc_error(10);t.checked=!0,smc_usertype=1,smc_fill_countries(),smc_fill_pricingareas(),smc_rehydrate(),smc_update_button(),i=document.getElementById("loadingmsg"),i&&(i.style.display="none")}function smc_changequal(){try{smc_changequal2()}catch(n){smc_error(2)}}function smc_changequal2(){var t=document.getElementById("quallist"),n;if(!t)return smc_error(1);smc_computed_path="",n=t.selectedIndex;if(!smc_fillpaths(n))return;smc_update_button()}function smc_fillpaths(n){var t=!1;try{t=smc_fillpaths2(n)}catch(i){smc_error(3)}return t}function smc_fillpaths2(n){var t=document.getElementById("pathlist"),r,u,i;if(!t)return smc_error(4),!1;smc_remove_children(t);if(n==0)return t.disabled="disabled",!0;if(typeof window.smc_path_codes=="undefined"||typeof window.smc_path_titles=="undefined")return smc_error(5),!1;n--;if(typeof window.smc_path_codes[n]=="undefined"||typeof window.smc_path_titles[n]=="undefined")return smc_error(6),!1;r=smc_path_codes[n].length;if(r==0)return alert("This qualification has no viewable pathways"),!0;if(r!=smc_path_titles[n].length)return smc_error(7),!1;for(u=0,smc_path_codes[n][0]=="GEN_X_1"&&(smc_add_select_option(t,"GEN_X_1","New curriculum (14/15)"),u=1,r>1&&smc_add_select_option(t,"0","")),r>1&&(smc_add_select_option(t,"0","Choose a pathway (12/13 or 13/14)..."),smc_add_select_option(t,"0","")),i=u;i<r;i++)smc_add_select_option(t,smc_path_codes[n][i],smc_path_titles[n][i]+" ("+smc_path_codes[n][i].replace("_"," ").replace("_"," ")+")");return t.disabled="",!0}function smc_add_select_option(n,t,i){var r=document.createElement("option");r.appendChild(document.createTextNode(i)),r.setAttribute("value",t),n.appendChild(r)}function smc_fill_pricingareas(){try{smc_fill_pricingareas2()}catch(n){smc_error(8)}}function smc_fill_pricingareas2(){var i=document.getElementById("countrylist"),t,n;if(!i)return smc_error(25);t=i.options[i.selectedIndex].value;if(t.length!=5||t.charAt(2)!="-")return smc_error(27);t=t.substr(3),n=document.getElementById("pricearea");if(!n)return smc_error(9);smc_remove_children(n);if(t=="EN"){smc_add_select_option(n,"EN","England"),smc_add_select_option(n,"SC","Scotland"),smc_add_select_option(n,"WN","Wales"),smc_add_select_option(n,"NI","Northern Ireland"),smc_add_select_option(n,"ET","England (transitional)"),smc_add_select_option(n,"WT","Wales (transitional)");return}if(t=="IE"){smc_add_select_option(n,"IE","Republic of Ireland"),smc_add_select_option(n,"IT","Republic of Ireland (transitional)");return}if(t=="EU"){smc_add_select_option(n,"EU","European Union"),smc_add_select_option(n,"UT","European Union (transitional)");return}if(t=="OE"){smc_add_select_option(n,"OE","Other overseas"),smc_add_select_option(n,"OT","Other overseas (transitional)");return}return smc_error(28)}function smc_changepath(){smc_computed_path="",smc_update_button()}function smc_update_button(){var r=document.getElementById("updbtn"),t,n,i;if(!r)return smc_error(11);t=document.getElementById("pathlist");if(!t)return smc_error(4);n=document.getElementById("fetchbtn");if(!n)return smc_error(20);return i="0",t.selectedIndex>=0&&(i=t.options[t.selectedIndex].value),smc_usertype==1?n.disabled="disabled":smc_is_pi_okay()?n.disabled="":(i="0",n.disabled="disabled"),i=="0"?(r.disabled="disabled",!1):(r.disabled="",!0)}function smc_changeusertype(){var n=document.getElementById("user1");if(!n)return smc_error(10);smc_usertype=n.checked?1:2,smc_update_button()}function smc_changepi(){if(smc_usertype==1){var n=document.getElementById("user2");if(!n)return smc_error(13);n.checked="checked",smc_changeusertype()}else smc_update_button()}function smc_is_pi_okay(){var r=document.getElementById("studpi"),t,i,n;if(!r)return smc_error(12),!1;t=r.value;if(t.length!=8)return!1;n=t.charAt(0);if(!(n>="a"&&n<="z"||n>="A"&&n<="Z"))return!1;for(i=1;i<7;i++)if(t.charAt(i)<"0"||t.charAt(i)>"9")return!1;return n=t.charAt(7),n>="0"&&n<="9"||n=="x"||n=="X"?!0:!1}function smc_remove_children(n){while(n.childNodes[0])n.removeChild(n.childNodes[0])}function smc_rehydrate(){try{smc_rehydrate2()}catch(n){smc_error(15)}}function smc_fetchbasket(){var i=document.cookie+";",t=i.indexOf("X2SMC=");if(t<0)return 0;t+=6;var r=i.indexOf(";",t),u=i.substr(t,r-t),n=u.split("|");return n.length<5?(smc_error(14),0):(n[5]==undefined&&(n[5]=""),n[6]==undefined&&(n[6]=""),n[7]==undefined&&(n[7]="GB"),n)}function smc_rehydrate2(){var n=smc_fetchbasket();if(n==0)return;if(!smc_rehydrate_qual(n[0]))return;if(!smc_rehydrate_path(n[1]))return;if(!smc_rehydrate_usertype(n[2]))return;if(!smc_rehydrate_country(n[7]))return;smc_fill_pricingareas();if(!smc_rehydrate_pricingarea(n[3]))return;smc_student_pricing_area=n[4]}function smc_rehydrate_qual(n){var i=document.getElementById("quallist"),r,t;if(!i)return smc_error(1);if(n=="")return i.selectedIndex=0,r=document.getElementById("pathlist"),r?(smc_remove_children(r),r.disabled="disabled",!0):smc_error(4);for(t=0;t<i.options.length;t++)if(i.options[t].value==n)return i.selectedIndex=t,smc_fillpaths(t),!0;return smc_error(16,n),!1}function smc_rehydrate_path(n){var i=document.getElementById("pathlist"),u,t,r;if(!i)return smc_error(4);if(n=="")return i.selectedIndex=0,!0;for(u=n.indexOf("_X_"),u==5&&(smc_computed_path=n,n="GEN_X_1"),t=0;t<i.options.length;t++)if(i.options[t].value==n)return i.selectedIndex=t,!0;return n.indexOf("_99")>2?(alert("This student has completed all modules for the qualification.\r\n\r\nNote that pathway details have not been shown here."),!0):(r=document.getElementById("quallist"),alert("Path '"+n.replace("_"," ").replace("_"," ")+"' is not live for "+r.value+"."),!1)}function smc_rehydrate_usertype(n){var r,i,t;if(n=="ENQ")return r=document.getElementById("user1"),r?(r.checked=!0,smc_usertype=1,!0):(smc_error(10),!1);if(n.length==8){i=document.getElementById("user2");if(!i)return smc_error(13),!1;return i.checked=!0,smc_usertype=2,t=document.getElementById("studpi"),t?(t.value=n,!0):(smc_error(12),!1)}return smc_error(18,n),!1}function smc_rehydrate_pricingarea(n){var i=document.getElementById("pricearea"),t;if(!i)return smc_error(9),!1;for(t=0;t<i.options.length;t++)if(i.options[t].value==n){i.selectedIndex=t;break}return!0}function smc_update(){var n=[],u=document.getElementById("quallist"),r,f,i,t;if(!u)return smc_error(1);n[0]=u.options[u.selectedIndex].value;if(n[0]=="0"){alert("Select a qualification");return}r=document.getElementById("pathlist");if(!r)return smc_error(4);n[1]=r.options[r.selectedIndex].value;if(n[1]=="0"){alert("Select a path");return}n[2]="ENQ";if(smc_usertype==2){if(smc_is_pi_okay()==!1){alert("Enter a valid PI, or select 'Enquirer'");return}n[2]=document.getElementById("studpi").value.toUpperCase(),smc_computed_path.length>0&&(n[1]=smc_computed_path)}f=smc_student_pricing_area,n[2]=="ENQ"&&(f=""),i=document.getElementById("pricearea");if(!i)return smc_error(9);n[3]=i.options[i.selectedIndex].value,t=document.getElementById("countrylist");if(!t)return smc_error(25);n[7]=t.options[t.selectedIndex].value.substr(0,2)+"_"+escape(t.options[t.selectedIndex].text),n[4]=f,n[5]="",n[6]="",smc_savebasket(n),document.location.href="module-chooser.aspx"}function smc_savebasket(n){var t=n[0]+"|"+n[1]+"|"+n[2]+"|"+n[3]+"|"+n[4]+"|"+n[5]+"|"+n[6]+"|"+n[7];document.cookie="X2SMC="+t+";path=/;"}function smc_timestamp(){var n=new Date;return n.getDate()+"."+n.getHours()+"."+n.getMinutes()+"."+n.getSeconds()+"."+n.getMilliseconds()}function smc_fetchstudentqual(){var n=GetHttpObj(),r,t,i;if(!n){smc_error(21);return}r=document.getElementById("studpi");if(!r){smc_error(12);return}t=r.value.toUpperCase();if(t.length!=8)return;i=document.getElementById("ou-content"),i&&(i.style.display="none"),n.onreadystatechange=function(){var i,r;if(n.readyState==4&&n.status==200){if(n.responseText=="ERR1"){alert("You do not have permission to view student details.");return}if(n.responseText=="ERR4"){alert("Student details not found for "+t+".");return}if(n.responseText=="ERR5"){alert("Sorry, we were unable to fetch details for this student. This might have been a temporary problem so try again.");return}if(n.responseText=="ERR7"){alert("No details were found for "+t+".\r\n\r\nPlease check you have entered it correctly.");return}if(n.responseText=="ERR6"){alert("Student "+t+" is not registered on a new-framework qualification.");return}i=n.responseText.split("|");if(i.length!=6)return smc_error(22,n.responseText);i[0]!=t&&smc_error(23,n.responseText),smc_computed_path="";if(!smc_rehydrate_qual(i[2]))return;if(!smc_rehydrate_path(i[3]))return;if(!smc_rehydrate_country(i[4]))return;smc_fill_pricingareas();if(!smc_rehydrate_pricingarea(i[5]))return;r=smc_update_button();if(i[2]==""){alert("Student "+t+" is not registered on a new-framework qualification.\r\n\r\nSelect a qualification from the dropdown list.");return}r&&smc_update()}},n.open("GET","../action/staff-module-chooser-fetch.ashx?pi="+t+"&tt="+smc_timestamp(),!0),n.send(null)}function smc_addmodule(n,t,i){try{smc_addmodule2(n,t,i)}catch(r){smc_error(24)}}function smc_addmodule2(n,t,i){var r=smc_fetchbasket(),e,u,f;if(r==0)return;e=n+"_"+t+"_"+i+"_",u=null,r[5].length>0&&(u=r[5].split(","));if(u!=null)for(f=0;f<u.length;f++)if(u[f].indexOf(e)==0)return;r[5].length>0&&(r[5]+=","),r[5]+=e+"0",smc_savebasket(r)}function smc_empty_basket(){var n=smc_fetchbasket();if(n==0)return;n[5]="",smc_savebasket(n)}function smc_fill_countries(){try{smc_fill_countries2()}catch(n){smc_error(26)}}function smc_fill_countries2(){var t=document.getElementById("countrylist"),n;if(!t)return smc_error(25);for(smc_remove_children(t),n=0;n<smc_countries.length;n++)smc_add_select_option(t,smc_countries[n][0],smc_countries[n][1])}function smc_changecountry(){smc_fill_pricingareas(),smc_update_button()}function smc_rehydrate_country(n){var i,t;if(n==undefined||n.length<2)return!0;i=document.getElementById("countrylist");if(!i)return smc_error(25);for(t=0;t<i.options.length;t++)if(i.options[t].value.charAt(0)==n.charAt(0)&&i.options[t].value.charAt(1)==n.charAt(1))return i.selectedIndex=t,!0;return smc_error(29,n),!1}var smc_usertype=1,smc_student_pricing_area="",smc_computed_path="",smc_countries=[["GB-EN","United Kingdom"],["AF-OE","Afghanistan"],["AX-EU","Aland Islands"],["AL-OE","Albania"],["DZ-OE","Algeria"],["AS-OE","American Samoa"],["AD-EU","Andorra"],["AO-OE","Angola"],["AI-OE","Anguilla"],["AQ-OE","Antarctica"],["AG-OE","Antigua and Barbuda"],["AR-OE","Argentina"],["AM-OE","Armenia"],["AW-OE","Aruba"],["AU-OE","Australia"],["AT-EU","Austria"],["AZ-OE","Azerbaijan"],["BS-OE","Bahamas"],["BH-OE","Bahrain"],["BD-OE","Bangladesh"],["BB-OE","Barbados"],["BY-OE","Belarus"],["BE-EU","Belgium"],["BZ-OE","Belize"],["BJ-OE","Benin"],["BM-OE","Bermuda"],["BT-OE","Bhutan"],["BO-OE","Bolivia"],["BQ-OE","Bonaire"],["BA-OE","Bosnia and Herzegovina"],["BW-OE","Botswana"],["BV-OE","Bouvet Island"],["BR-OE","Brazil"],["IO-OE","British Indian Ocean Territory"],["BN-OE","Brunei Darussalam"],["BG-EU","Bulgaria"],["BF-OE","Burkina Faso"],["BI-OE","Burundi"],["KH-OE","Cambodia"],["CM-OE","Cameroon"],["CA-OE","Canada"],["CV-OE","Cape Verde"],["KY-OE","Cayman Islands"],["CF-OE","Central African Republic"],["TD-OE","Chad"],["CL-OE","Chile"],["CN-OE","China"],["CX-OE","Christmas Island"],["CC-OE","Cocos (Keeling) Islands"],["CO-OE","Colombia"],["KM-OE","Comoros"],["CG-OE","Congo"],["CD-OE","Congo (Democratic Republic of the)"],["CK-OE","Cook Islands"],["CR-OE","Costa Rica"],["CI-OE","Cote D'Ivoire"],["HR-EU","Croatia"],["CW-OE","Curacao"],["CY-EU","Cyprus"],["CZ-EU","Czech Republic"],["DK-EU","Denmark"],["DJ-OE","Djibouti"],["DM-OE","Dominica"],["DO-OE","Dominican Republic"],["EC-OE","Ecuador"],["EG-OE","Egypt"],["SV-OE","El Salvador"],["GQ-OE","Equatorial Guinea"],["ER-OE","Eritrea"],["EE-EU","Estonia"],["ET-OE","Ethiopia"],["FK-OE","Falkland Islands (Malvinas)"],["FO-OE","Faroe Islands"],["FJ-OE","Fiji"],["FI-EU","Finland"],["MK-OE","Former Yugoslav Republic of Macedonia"],["FR-EU","France"],["GF-OE","French Guiana"],["PF-OE","French Polynesia"],["TF-OE","French Southern Territories"],["GA-OE","Gabon"],["GM-OE","Gambia"],["GE-OE","Georgia"],["DE-EU","Germany"],["GH-OE","Ghana"],["GI-EU","Gibraltar"],["GR-EU","Greece"],["GL-OE","Greenland"],["GD-OE","Grenada"],["GP-OE","Guadeloupe"],["GU-OE","Guam"],["GT-OE","Guatemala"],["GN-OE","Guinea"],["GW-OE","Guinea-Bissau"],["GY-OE","Guyana"],["HT-OE","Haiti"],["HM-OE","Heard and McDonald Islands"],["VA-EU","Holy See (Vatican City State)"],["HN-OE","Honduras"],["HK-OE","Hong Kong"],["HU-EU","Hungary"],["IS-EU","Iceland"],["IN-OE","India"],["ID-OE","Indonesia"],["IQ-OE","Iraq"],["IL-OE","Israel"],["IT-EU","Italy"],["JM-OE","Jamaica"],["JP-OE","Japan"],["JO-OE","Jordan"],["KZ-OE","Kazakhstan"],["KE-OE","Kenya"],["KI-OE","Kiribati"],["KR-OE","Korea (Republic of)"],["KW-OE","Kuwait"],["KG-OE","Kyrgyzstan"],["LA-OE","Lao People's Democratic Republic"],["LV-EU","Latvia"],["LB-OE","Lebanon"],["LS-OE","Lesotho"],["LR-OE","Liberia"],["LY-OE","Libya"],["LI-EU","Liechtenstein"],["LT-EU","Lithuania"],["LU-EU","Luxembourg"],["MO-OE","Macau"],["MG-OE","Madagascar"],["MW-OE","Malawi"],["MY-OE","Malaysia"],["MV-OE","Maldives"],["ML-OE","Mali"],["MT-EU","Malta"],["MH-OE","Marshall Islands"],["MQ-OE","Martinique"],["MR-OE","Mauritania"],["MU-OE","Mauritius"],["YT-OE","Mayotte"],["MX-OE","Mexico"],["FM-OE","Micronesia"],["MD-OE","Moldova"],["MC-EU","Monaco"],["MN-OE","Mongolia"],["ME-OE","Montenegro"],["MS-OE","Montserrat"],["MA-OE","Morocco"],["MZ-OE","Mozambique"],["NA-OE","Namibia"],["NR-OE","Nauru"],["NP-OE","Nepal"],["NL-EU","Netherlands"],["NC-OE","New Caledonia"],["NZ-OE","New Zealand"],["NI-OE","Nicaragua"],["NE-OE","Niger"],["NG-OE","Nigeria"],["NU-OE","Niue"],["NF-OE","Norfolk Island"],["MP-OE","Northern Mariana Islands"],["NO-EU","Norway"],["OM-OE","Oman"],["PK-OE","Pakistan"],["PW-OE","Palau"],["PS-OE","Palestine"],["PA-OE","Panama"],["PG-OE","Papua New Guinea"],["PY-OE","Paraguay"],["PE-OE","Peru"],["PH-OE","Philippines"],["PN-OE","Pitcairn"],["PL-EU","Poland"],["PT-EU","Portugal"],["PR-OE","Puerto Rico"],["QA-OE","Qatar"],["IE-IE","Republic of Ireland"],["RE-OE","Reunion"],["RO-EU","Romania"],["RU-OE","Russian Federation"],["RW-OE","Rwanda"],["BL-OE","Saint Barthelemy"],["KN-OE","Saint Kitts and Nevis"],["LC-OE","Saint Lucia"],["MF-OE","Saint Martin (French part)"],["VC-OE","Saint Vincent and The Grenadines"],["WS-OE","Samoa"],["SM-EU","San Marino"],["ST-OE","Sao Tome and Principe"],["SA-OE","Saudi Arabia"],["SN-OE","Senegal"],["RS-OE","Serbia"],["SC-OE","Seychelles"],["SL-OE","Sierra Leone"],["SG-OE","Singapore"],["SX-OE","Sint Maarten (Dutch part)"],["SK-EU","Slovakia"],["SI-EU","Slovenia"],["SB-OE","Solomon Islands"],["SO-OE","Somalia"],["ZA-OE","South Africa"],["GS-OE","South Georgia and the South Sandwich Islands"],["SS-OE","South Sudan"],["ES-EU","Spain"],["LK-OE","Sri Lanka"],["SH-OE","St Helena"],["PM-OE","St. Pierre and Miquelon"],["SR-OE","Suriname"],["SJ-OE","Svalbard and Jan Mayen Islands"],["SZ-OE","Swaziland"],["SE-EU","Sweden"],["CH-EU","Switzerland"],["TW-OE","Taiwan (Province of China)"],["TJ-OE","Tajikistan"],["TZ-OE","Tanzania (United Republic of)"],["TH-OE","Thailand"],["TL-OE","Timor-Leste"],["TG-OE","Togo"],["TK-OE","Tokelau"],["TO-OE","Tonga"],["TT-OE","Trinidad and Tobago"],["TN-OE","Tunisia"],["TR-OE","Turkey"],["TM-OE","Turkmenistan"],["TC-OE","Turks and Caicos Islands"],["TV-OE","Tuvalu"],["UG-OE","Uganda"],["UA-OE","Ukraine"],["MM-OE","Union of Myanmar"],["AE-OE","United Arab Emirates"],["UM-OE","United States Minor Outlying Islands"],["US-OE","United States of America"],["UY-OE","Uruguay"],["UZ-OE","Uzbekistan"],["VU-OE","Vanuatu"],["VE-OE","Venezuela"],["VN-OE","Viet Nam"],["VG-OE","Virgin Is (GB)"],["VI-OE","Virgin Is (US)"],["WF-OE","Wallis and Futuna Islands"],["EH-OE","Western Sahara"],["YE-OE","Yemen"],["ZM-OE","Zambia"],["ZW-OE","Zimbabwe"]]